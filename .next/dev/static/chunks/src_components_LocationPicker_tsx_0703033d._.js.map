{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/limva/Downloads/Attendance%20System%20Website%20Design/src/components/LocationPicker.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState, useRef } from 'react';\r\nimport L from 'leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\n\r\n// Fix for default marker icon in Next.js\r\nimport markerIcon2x from 'leaflet/dist/images/marker-icon-2x.png';\r\nimport markerIcon from 'leaflet/dist/images/marker-icon.png';\r\nimport markerShadow from 'leaflet/dist/images/marker-shadow.png';\r\n\r\ninterface LocationPickerProps {\r\n  initialLat?: number;\r\n  initialLng?: number;\r\n  onLocationSelect: (lat: number, lng: number) => void;\r\n}\r\n\r\nexport default function LocationPicker({ initialLat, initialLng, onLocationSelect }: LocationPickerProps) {\r\n  const mapRef = useRef<L.Map | null>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const markerRef = useRef<L.Marker | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [selectedLocation, setSelectedLocation] = useState<{lat: number, lng: number} | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!containerRef.current) return;\r\n\r\n    // Fix Leaflet default icon issue - create custom icon\r\n    const customIcon = L.icon({\r\n      iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',\r\n      iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',\r\n      shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',\r\n      iconSize: [25, 41],\r\n      iconAnchor: [12, 41],\r\n      popupAnchor: [1, -34],\r\n      shadowSize: [41, 41]\r\n    });\r\n\r\n    // Create map instance\r\n    const center: [number, number] = initialLat && initialLng \r\n      ? [initialLat, initialLng] \r\n      : [40.7128, -74.0060];\r\n\r\n    const map = L.map(containerRef.current).setView(center, initialLat && initialLng ? 15 : 4);\r\n\r\n    // Add tile layer\r\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n      attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n      maxZoom: 19\r\n    }).addTo(map);\r\n\r\n    // Add click handler\r\n    map.on('click', (e: L.LeafletMouseEvent) => {\r\n      const { lat, lng } = e.latlng;\r\n      \r\n      // Remove old marker if exists\r\n      if (markerRef.current) {\r\n        markerRef.current.remove();\r\n      }\r\n      \r\n      // Add new marker with custom icon\r\n      markerRef.current = L.marker([lat, lng], { icon: customIcon })\r\n        .addTo(map)\r\n        .bindPopup(`Location: ${lat.toFixed(6)}, ${lng.toFixed(6)}`)\r\n        .openPopup();\r\n      \r\n      // Update state\r\n      setSelectedLocation({ lat, lng });\r\n      \r\n      // Call callback\r\n      onLocationSelect(lat, lng);\r\n    });\r\n\r\n    // Try to get user's location\r\n    map.locate({ setView: false, maxZoom: 15 });\r\n    \r\n    map.on('locationfound', (e: L.LocationEvent) => {\r\n      if (!markerRef.current) {\r\n        markerRef.current = L.marker(e.latlng, { icon: customIcon })\r\n          .addTo(map)\r\n          .bindPopup('Your current location')\r\n          .openPopup();\r\n        map.flyTo(e.latlng, 15);\r\n        setSelectedLocation({ lat: e.latlng.lat, lng: e.latlng.lng });\r\n        onLocationSelect(e.latlng.lat, e.latlng.lng);\r\n      }\r\n    });\r\n\r\n    mapRef.current = map;\r\n    setIsLoading(false);\r\n\r\n    // Cleanup function\r\n    return () => {\r\n      if (markerRef.current) {\r\n        markerRef.current.remove();\r\n        markerRef.current = null;\r\n      }\r\n      if (mapRef.current) {\r\n        mapRef.current.remove();\r\n        mapRef.current = null;\r\n      }\r\n    };\r\n  }, []); // Empty dependency array - only run once\r\n\r\n  return (\r\n    <div className=\"space-y-3\">\r\n      {isLoading && (\r\n        <div className=\"absolute inset-0 bg-secondary/50 rounded-lg flex items-center justify-center z-10\">\r\n          <p className=\"text-muted-foreground\">Loading map...</p>\r\n        </div>\r\n      )}\r\n      <div \r\n        ref={containerRef} \r\n        className=\"h-96 rounded-lg overflow-hidden border border-border relative\"\r\n        style={{ height: '384px', width: '100%' }}\r\n      />\r\n      <div className=\"text-sm text-center space-y-1\">\r\n        <p className=\"text-muted-foreground\">\r\n          Click anywhere on the map to set the location\r\n        </p>\r\n        {selectedLocation && (\r\n          <p className=\"text-primary font-medium\">\r\n            Selected: {selectedLocation.lat.toFixed(6)}, {selectedLocation.lng.toFixed(6)}\r\n          </p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}